---
title: "Defining Development Environment"
editor_options: 
  chunk_output_type: console
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

To reproduce the results of this project, follow these steps to set up the same environment:

### 1. Install Docker

You'll need to install **Docker**. Choose the appropriate installation method for your operating system:

  * **Windows or macOS**: Install [Docker Desktop](https://www.docker.com/products/docker-desktop/).
  * **Linux**: Install the [Docker Engine](https://docs.docker.com/engine/install/).

For Debian 13:

The following script is an adapted version for **Debian 13**. Run it as a superuser to install Docker Engine:

```bash
apt update
apt install -y apt-transport-https ca-certificates curl gnupg2 software-properties-common
curl -fsSL https://download.docker.com/linux/debian/gpg | apt-key add -
add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/debian trixie stable"
apt update
apt-cache policy docker-ce
apt install -y docker-ce
systemctl status docker
usermod -aG docker <YOUR-USER>
su - <YOUR-USER>
```

**Note:** Replace `<YOUR-USER>` with your actual username.


### 2. Download the Project Image

Pull the Docker image associated with this project using the following command:

```bash
docker pull angelfelizr/nyc-taxi-nix:4.5.1
```

### 3. Clone the Repository

Navigate to the parent directory where you want to store the project and another folder to store big data files. Then, clone the repository:

```bash
cd <parent-dir-path>
mkdir NycTaxiBigFiles
git clone https://github.com/AngelFelizR/NycTaxi
```

### 4. Run the Docker Container

Execute the command below to run the container based on the `angelfelizr/nyc-taxi-nix:4.5.1` image. This command will:

  * Remove the container when you exit (`--rm`).
  * Give the container a name for easy identification (`--name nyc-taxi-container`).
  * Publish port 2222 on the host and map it to port 22 inside the container, enabling SSH access.
  * Mount the cloned repository to the `/root/NycTaxi` directory within the container (`-v <parent-dir-path>/NycTaxi:/root/NycTaxi`).


```bash
docker run -tid --rm \
  --name nyc-taxi-container \
  -p 2222:22 \
  -v <parent-dir-path>/NycTaxi:/root/NycTaxi \
  -v <parent-dir-path>/NycTaxiBigFiles:/root/NycTaxiBigFiles \
  angelfelizr/nyc-taxi-nix:4.5.1
```

### 5. Access the Container

You have two options to access the container:

1.  **Using the Terminal**: Run the following command and use `"r"` as the password to SSH into the container:

```bash
ssh root@localhost -p 2222
```

2.  **Using Positron**: Select the **"Connect to Host"** option in **Positron** and enter `root@localhost:2222` with `"r"` as the password. Then we just need to install the [direnv](https://open-vsx.org/vscode/item?itemName=mkhl.direnv) extention by **mkhl**.


### 6. Start the Nix Shell

Once inside the container, navigate to the `NycTaxi` folder and start the Nix shell by running the following command:

```bash
cd NycTaxi
nix-shell
```